var app={};app.youTubeKey="AIzaSyD4tral4uWGhAuXca57lW0x2En9r1u-m0g",app.echoNestKey="UERCJAEULHNDGA8KX",app.videos=[],app.songs=[],app.origSongId="",$.ajaxSettings.traditional=!0,app.getSong=function(e){$.ajax({url:"http://developer.echonest.com/api/v4/song/search",type:"GET",data:{api_key:app.echoNestKey,format:"json",combined:e,results:1},success:function(e){app.origSongId=e.response.songs[0].id,app.getSongTempAndKey(app.origSongId)}})},app.getTrackInfoById=function(e){return $.ajax({url:"http://developer.echonest.com/api/v4/song/profile",type:"GET",data:{api_key:app.echoNestKey,format:"json",id:e,results:1,bucket:["tracks","id:7digital-US","audio_summary"]}})},app.getSongTempAndKey=function(e){$.ajax({url:"http://developer.echonest.com/api/v4/song/profile",type:"GET",data:{api_key:app.echoNestKey,id:e,bucket:"audio_summary"},success:function(e){var a=e.response.songs[0].audio_summary.key,n=e.response.songs[0].audio_summary.tempo;app.searchByTempAndKey(a,n)}})},app.searchByTempAndKey=function(e,a){$.ajax({url:"http://developer.echonest.com/api/v4/song/search",type:"GET",dataType:"jsonp",data:{format:"jsonp",key:e,api_key:app.echoNestKey,max_tempo:a,min_tempo:a},success:function(e){var a=e.response.songs[0].id;$.when(app.getTrackInfoById(a),app.getTrackInfoById(app.origSongId)).then(function(e,a,n){app.displayFirstSongInfo(e,a,n)})}})},app.events=function(){$(".search").on("submit",function(e){e.preventDefault();var a=$(this).find("input[type=search]").val();console.log("The query: ",a),app.getSong(a)})},app.displayFirstSongInfo=function(e){$("#matchedSong,#matchedArtist,#matchedAlbum").empty();var a=e[0].response.songs[0].title,n=e[0].response.songs[0].artist_name;if(console.log(a),console.log(n),console.log(t),$("#matchedArtist").text("Artist: "+n),$("#matchedSong").text("Song: "+a),e[0].response.songs[0].tracks.length>0){var t=$("<img>").attr("src",e[0].response.songs[0].tracks[0].release_image);$("#matchedAlbum").append(t)}},app.init=function(){app.events()},$(function(){app.init()}),jQuery(document).ready(function($){$(".cd-btn").on("click",function(e){e.preventDefault(),$(".cd-panel").addClass("is-visible")}),$(".cd-panel").on("click",function(e){($(e.target).is(".cd-panel")||$(e.target).is(".cd-panel-close"))&&($(".cd-panel").removeClass("is-visible"),e.preventDefault())})});